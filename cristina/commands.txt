> source(“http://bioconductor.org/biocLite.R”)
> library(“GEOquery”)
> expr = getGEO(filename="/Users/cristinaleal/Documents/IEO/PROJECT/GSE13041-GPL96_series_matrix.txt")
> pdata = pData(expr)
> pdata_PN = pdata[pdata$characteristics_ch1.4 == "HC: PN",]
> pdata_rest = rbind(pdata_Pro, pdata_Mes, pdata_ProMes)

#randomise acquisition of samples in pdata_PN and pdata_rest:

> sampling_rest = pdata_rest[sample(nrow(pdata_rest),20),]
> sampling_PN = pdata_PN[sample(nrow(pdata_PN),20),]

# Quality assessment
> celdir = "/Users/cristinaleal/GitHub/Project_IEO/data/"
> glio = ReadAffy(celfile.path = celdir)

With the samples selected from before we create a subset of affybatch object with the 40 samples:
> celdir2 = "/Users/cristinaleal/Documents/IEO/PROJECT/filtered/"
> filtered_affy = ReadAffy(celfile.path = celdir2)
> filtered_affy

Subsets of 10 samples from the filtered_affy(40 samples):
> filtered_affy.subset3 <- filtered_affy[,21:30]
> rm(filtered_affy.subset)
> filtered_affy.subset4 <- filtered_affy[,31:40]
> filtered_affy.subset2 <- filtered_affy[,11:20]
> filtered_affy.subset1 <- filtered_affy[,1:10]

For each subset create images comparing the microarrays:
> par(mfrow = c(2, 5), mar = c(1, 1, 3, 1))
> image(filtered_affy.subset2)


Raw intensity values distribution:
> boxplot(filtered_affy, las=2, main="Raw intensity values distribution Boxplot")


NUSE plots:
> library(affyPLM)
> Pset <- fitPLM(MLL.B.subset)
> NUSE(Pset, las=2, main="NUSE plots")

How to discard bad samples:
> rleDiag <- RLE(Pset, type="stats")
> nuseDiag <- NUSE(Pset, type = "stats")
> badNuseRleChips <- which(nuseDiag["median", ] > 1.05 | abs(rleDiag["median",]) > 0.1)

sorted:
> sort(nuseDiag["median", ], decreasing = TRUE)
> sort(abs(rleDiag["median", ]), decreasing = TRUE)

## AnnotatedDataFrame object
> gset <- getGEO(filename="GSE13041-GPL96_series_matrix.txt", GSEMatrix=TRUE)
> annotated = featureData(gset)
> phenoData(filtered_affy) <- annotated
# annotated = phenodata (del AnnotatedDataFrame .txt)
# filtered_affy = AffyBatch object with the 40 samples chosen
